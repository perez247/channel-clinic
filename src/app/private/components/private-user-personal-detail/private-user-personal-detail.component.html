

<form [formGroup]="form">
    <div class="row">

        <div class="col-sm-3 position-relative text-center">
            <img appDisplayProfileImage [imgSrc]="user?.profile" class="img-fluid m-auto" [ngClass]="{'border border-danger border-3': errorService.getError(form, 'profile')}">
            <fa-icon (click)="openUploadProfileModal()" *ngIf="!disableForm" [icon]="fonts.faPencilAlt" class="edit-pic text-primary pointer bg-white p-2 rounded"></fa-icon>
            <fa-icon (click)="updateProfilePicture('')" *ngIf="!disableForm && user?.profile" [icon]="fonts.faTrash" class="edit-pic-trash text-danger pointer bg-white p-2 rounded"></fa-icon>
            <div class="position-relative">
                <strong>
                    <app-custom-error-message [errorMessage]="errorService.getError(form, 'profile')"></app-custom-error-message>
                </strong>
            </div>
        </div>

        <div class="col-sm-9">
            <fieldset [disabled]=disableForm>
                <div class="row">

                    <div class="form-group col-12 col-sm-6 position-relative">

                        <div class="w-100 position-relative">
                        <label class="form-control-label mb-2" for="firstNameField">
                            <strong>First Name</strong>
                        </label>
                        <input placeholder="First Name" maxlength="250" type="text" class="form-control" id="firstNameField" formControlName="firstName"  [ngClass]="{'is-invalid': errorService.getError(form, 'firstName')}">
                        <app-custom-error-message [errorMessage]="errorService.getError(form, 'firstName')"></app-custom-error-message>
                        </div>

                    </div>

                    <div class="form-group col-12 col-sm-6">
                        <label class="form-control-label mb-2" for="lastNameField"><strong>Last Name</strong></label>
                        <input placeholder="Last Name" maxlength="250" type="text" class="form-control" id="lastNameField" formControlName="lastName"  [ngClass]="{'is-invalid': errorService.getError(form, 'lastName')}">
                        <app-custom-error-message [errorMessage]="errorService.getError(form, 'lastName')"></app-custom-error-message>
                    </div>

                    <div class="form-group col-12 col-sm-6">
                        <label class="form-control-label mb-2" for="otherNameField"><strong>Other Name</strong></label>
                        <input placeholder="Other Name" maxlength="250" type="text" class="form-control" id="otherNameField" formControlName="otherName"  [ngClass]="{'is-invalid': errorService.getError(form, 'otherName')}">
                        <app-custom-error-message [errorMessage]="errorService.getError(form, 'otherName')"></app-custom-error-message>
                    </div>

                    <div class="form-group col-12 col-sm-6">
                        <label class="form-control-label mb-2" for="emailField"><strong>Email</strong></label>
                        <input placeholder="Email" maxlength="250" type="email" class="form-control" id="emailField" formControlName="email"  [ngClass]="{'is-invalid': errorService.getError(form, 'email')}">
                        <app-custom-error-message [errorMessage]="errorService.getError(form, 'email')"></app-custom-error-message>
                    </div>

                    <div class="form-group col-12 col-sm-6">
                        <label class="form-control-label mb-2" for="phoneField"><strong>Phone</strong></label>
                        <input placeholder="Phone" maxlength="200" type="text" class="form-control" id="phoneField" formControlName="phone"  [ngClass]="{'is-invalid': errorService.getError(form, 'phone')}">
                        <app-custom-error-message [errorMessage]="errorService.getError(form, 'phone')"></app-custom-error-message>
                    </div>

                    <div class="form-group col-12 col-sm-6">
                        <label class="form-control-label mb-2" for="genderField"><strong>Gender</strong></label>
                        <select class="form-control" id="genderField" formControlName="gender"  [ngClass]="{'is-invalid': errorService.getError(form, 'gender')}">
                            <option>---</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>
                        </select>
                        <app-custom-error-message [errorMessage]="errorService.getError(form, 'gender')"></app-custom-error-message>
                    </div>

                    <ng-container *ngIf="user?.patient">
                        
                        <div class="form-group col-12 col-sm-6">
                            <label class="form-control-label mb-2" for="bloodGroupField"><strong>Blood Group</strong></label>
                            <input placeholder="Blood Group" maxlength="200" type="text" class="form-control" id="bloodGroupField" formControlName="bloodGroup"  [ngClass]="{'is-invalid': errorService.getError(form, 'bloodGroup')}">
                            <app-custom-error-message [errorMessage]="errorService.getError(form, 'bloodGroup')"></app-custom-error-message>
                        </div>

                        <div class="form-group col-12 col-sm-6">
                            <label class="form-control-label mb-2" for="companyUniqueIdField"><strong>Company Unique Id</strong></label>
                            <input placeholder="Company Unique Id" maxlength="255" type="text" class="form-control" id="companyUniqueIdField" formControlName="companyUniqueId"  [ngClass]="{'is-invalid': errorService.getError(form, 'companyUniqueId')}">
                            <app-custom-error-message [errorMessage]="errorService.getError(form, 'companyUniqueId')"></app-custom-error-message>
                        </div>
                    </ng-container>

                    <div class="form-group col-12">
                        <label class="form-control-label mb-2" for="occupationField"><strong>Occupation</strong></label>
                        <input placeholder="Occupation" maxlength="200" type="text" class="form-control" id="occupationField" formControlName="occupation"  [ngClass]="{'is-invalid': errorService.getError(form, 'occupation')}">
                        <app-custom-error-message [errorMessage]="errorService.getError(form, 'occupation')"></app-custom-error-message>
                    </div>

                    <div class="form-group col-12">
                        <label class="form-control-label mb-2" for="addressField"><strong>Address</strong></label>
                        <input placeholder="Address" maxlength="1000" type="email" class="form-control" id="addressField" formControlName="address"  [ngClass]="{'is-invalid': errorService.getError(form, 'address')}">
                        <app-custom-error-message [errorMessage]="errorService.getError(form, 'address')"></app-custom-error-message>
                    </div>

                    <ng-container *ngIf="user?.patient">
                      <div class="form-group col-12">
                        <label class="form-control-label mb-2" for="otherInformationField"><strong>Other Information</strong></label>

                        <textarea placeholder="Other related information" maxlength="2000" rows="4" class="form-control" id="otherInformationField" formControlName="otherInformation"  [ngClass]="{'is-invalid': errorService.getError(form, 'otherInformation')}"> </textarea>
                        <app-custom-error-message [errorMessage]="errorService.getError(form, 'otherInformation')"></app-custom-error-message>
                        <div class="d-flex justify-content-end ">
                          <small>{{form.get('otherInformation')?.value?.length ?? 0}}/2000</small>
                        </div>
                      </div>
                    </ng-container>

                </div>
            </fieldset>

            <div class="row">
                <div class="col-12">

                    <div appHasRole [roles]="editRoles" [operator]="'or'" class="d-flex justify-content-end" *ngIf="disableForm" >
                        <button (click)="edit()" class="btn btn-primary">Edit</button>
                    </div>

                    <div class="d-flex justify-content-between" *ngIf="!disableForm">
                        <button (click)="beginUpdate()" [disabled]="form.invalid || isLoading" class="btn btn-success">
                            Update
                            <app-shared-loading *ngIf="isLoading"></app-shared-loading>
                        </button>

                        <button (click)="cancelEdit()" class="btn btn-danger">Cancel</button>
                    </div>

                </div>
            </div>
        </div>

    </div>
</form>
